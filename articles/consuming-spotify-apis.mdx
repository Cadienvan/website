---
title: 'How to consume Spotify APIs using Next.js and JavaScript'
date: 2022-06-01T12:33:33.333Z
description: 'Hello stranger! In this article I will show you how I made my blog serverless with Next.js and MDX.'
tags:
  - next.js
  - spotify
  - javascript
  - apis
image: '/images/articles/consuming-spotify-apis/cover.png'
author:
  name: Mateo
  image: '/images/profile.jpeg'
---

<Image
  src="/images/articles/consuming-spotify-apis/cover.png"
  width="1280"
  height="720"
  layout="responsive"
  alt="'How to consume Spotify APIs using Next.js and Node.js"
  href="/blog/consuming-spotify-apis"
/>

Finally, another article in my (poor üòì) blog. Sometimes I don't know what to say, or what to explain you. But in this case, I show you how I've integrated **Spotify** API's into my website.

As you can see in this [section](https://mateonunez.dev/spotify) I made 2 sections showing you my the **Last Songs I Played**, the **Top Artists** and my **Top Tracks**.

## üë®‚Äçüç≥Ô∏è Ingredients

- [next](https://nextjs.org/) | `v12.1.5`
- [react](https://reactjs.org/) | `v18.0`
- [tailwindcss](https://tailwindcss.com/) | `v3.0.23` _(optional)_
- [Spotify Docs](https://developer.spotify.com/documentation/web-api/) | `REQUIRED `

## üîë Authorization Code Flow

<Image
  src="/images/articles/consuming-spotify-apis/authorization-code-flow.png"
  width="1068"
  height="970"
  layout="responsive"
  alt="'Authorization Code Flow' - How to consume Spotify APIs using Next.js and Node.js"
  href="/images/articles/consuming-spotify-apis/authorization-code-flow.png"
  target="_blank"
/>

Is the image above clear? (not for me)

Now, Spotify has a lot types of _Authentication_ flows ([read more](https://developer.spotify.com/documentation/general/guides/authorization/)). I'll use the **Authorization Code Flow**, I'll run the flow locally because the only person who can access my API is me.

The first step is to create a new Application in [Spotify Dashboard](https://developer.spotify.com/).

<Image
  src="/images/articles/consuming-spotify-apis/dashboard.png"
  width="1660"
  height="753"
  layout="responsive"
  alt="'New Application on Spotify Dashboard' - How to consume Spotify APIs using Next.js and Node.js"
  href="/images/articles/consuming-spotify-apis/dashboard.png"
  target="_blank"
/>

> Bro are you serious? Do I have explain you how to create a new application? I'm a developer, not a philosopher.

> The only thing I can say is that you need add (into the Redirect URIs your `localhost:port` for development). I think it's enough.

When you're done, you'll have a new application, a new `Client ID` and a new `Client Secret`, required for the next step.

Personally, I prefer to store the `Client ID` and `Client Secret` in a `.env` file, but you can use any other way.

> .env.local.example

```env
# Spotify
SPOTIFY_CLIENT_ID=
SPOTIFY_CLIENT_SECRET=
SPOTIFY_REFRESH_TOKEN=
SPOTIFY_REDIRECT_URI=
```

### Request authorization to access data

The first step is to compose the URL to request the authorization. It is comopsed by the following parameters:

```
https://accounts.spotify.com/authorize?client_id=${CLIENT_ID}&response_type=code&redirect_uri=${REDIRECT_URI}&scope=${SCOPES}
```

In my case I've indicated as `${REDIRECT_URI}` my `localhost:port` for development (keep in mind that you need to add this in the Redirect URIs section on Spotify Dashboard).

The list of my scopes:

- user-read-currently-playing
- user-read-recently-played
- user-read-playback-state
- user-read-playback-position
- user-top-read
- playlist-read-collaborative
- playlist-read-private

[Read More about Spotify Authorization Scopes](https://developer.spotify.com/documentation/general/guides/authorization/scopes/)

Visit the composed URL. After you're done, you'll have a new URL with the `code` parameter in the Redirect URI you've indicated.

> http://localhost:3000/?code=AQAwWOR1VPrAsrsRhAVzPOGg2Dg....

Save that code.

The following step is to encode the `${CLIENT_ID}:${CLIENT_SECRET}` variables in Base64.

```bash
> echo -n "${CLIENT_ID}:${CLIENT_SECRET}" | base64
```

> or just use [base64encode](https://www.base64encode.org/)

When you have encrypted the `${CLIENT_ID}` and the `${CLIENT_SECRET}`, sperated by `:`, you can compose the URL to request the authorization that we will use in the next step.

```bash
curl -H "Authorization: Basic ${CLIENT_PARAMETERS_IN_BASE64}" -d grant_type=authorization_code -d code=${AUTHORIZATION_CODE} -d redirect_uri=http%3A%2F%2Flocalhost:3000 https://accounts.spotify.com/api/token
```

The response will be something like this:

```json
{
  "access_token": "ACCESS_TOKEN",
  "token_type": "Bearer",
  "expires_in": 3600,
  "refresh_token": "REFRESH_TOKEN",
  "scope": "playlist-read-private playlist-read-collaborative user-read-playback-state user-read-currently-playing user-read-recently-played user-read-playback-position user-top-read"
}
```

The `access_token` allows you to access the API data.

A simple example of how to use the `access_token` to get the current user's data:

**Request:**

```bash
curl -X "GET" "https://api.spotify.com/v1/me/player/currently-playing" -H "Accept: application/json" -H "Content-Type: application/json" -H "Authorization: Bearer ${ACCESS_TOKEN}"
```

**Response:**

```json
{
  timestamp: 1657357734036,
  context: {
    external_urls: {
      spotify: 'https://open.spotify.com/playlist/5yIhKIf3Hf3g8HOLNGYWeM'
    },
    href: 'https://api.spotify.com/v1/playlists/5yIhKIf3Hf3g8HOLNGYWeM',
    type: 'playlist',
    uri: 'spotify:playlist:5yIhKIf3Hf3g8HOLNGYWeM'
  },
  progress_ms: 9490,
  item: {
    album: {
      album_type: 'album',
      artists: [Array],
      available_markets: [Array],
      external_urls: [Object],
      href: 'https://api.spotify.com/v1/albums/2noRn2Aes5aoNVsU6iWThc',
      id: '2noRn2Aes5aoNVsU6iWThc',
      images: [Array],
      name: 'Discovery',
      release_date: '2001-03-12',
      release_date_precision: 'day',
      total_tracks: 14,
      type: 'album',
      uri: 'spotify:album:2noRn2Aes5aoNVsU6iWThc'
    },
    artists: [ [Object] ],
    available_markets: [
      'AD', 'AE', 'AG', 'AL', 'AM', 'AO', 'AR', 'AT', 'AU', 'AZ',
      'BA', 'BB', 'BD', 'BE', 'BF', 'BG', 'BH', 'BI', 'BJ', 'BN',
      'BO', 'BR', 'BS', 'BT', 'BW', 'BY', 'BZ', 'CA', 'CD', 'CG',
      'CH', 'CI', 'CL', 'CM', 'CO', 'CR', 'CV', 'CW', 'CY', 'CZ',
      'DE', 'DJ', 'DK', 'DM', 'DO', 'DZ', 'EC', 'EE', 'EG', 'ES',
      'FI', 'FJ', 'FM', 'FR', 'GA', 'GB', 'GD', 'GE', 'GH', 'GM',
      'GN', 'GQ', 'GR', 'GT', 'GW', 'GY', 'HK', 'HN', 'HR', 'HT',
      'HU', 'ID', 'IE', 'IL', 'IN', 'IQ', 'IS', 'IT', 'JM', 'JO',
      'JP', 'KE', 'KG', 'KH', 'KI', 'KM', 'KN', 'KR', 'KW', 'KZ',
      'LA', 'LB', 'LC', 'LI', 'LK', 'LR', 'LS', 'LT', 'LU', 'LV',
      ... 83 more items
    ],
    disc_number: 1,
    duration_ms: 320357,
    explicit: false,
    external_ids: { isrc: 'GBDUW0000053' },
    external_urls: {
      spotify: 'https://open.spotify.com/track/0DiWol3AO6WpXZgp0goxAV'
    },
    href: 'https://api.spotify.com/v1/tracks/0DiWol3AO6WpXZgp0goxAV',
    id: '0DiWol3AO6WpXZgp0goxAV',
    is_local: false,
    name: 'One More Time',
    popularity: 77,
    preview_url: 'https://p.scdn.co/mp3-preview/18781de52205d9ade22904945510161feab085ce?cid=703d39064908445898701a125f391745',
    track_number: 1,
    type: 'track',
    uri: 'spotify:track:0DiWol3AO6WpXZgp0goxAV'
  },
  currently_playing_type: 'track',
  actions: { disallows: { resuming: true, skipping_prev: true } },
  is_playing: true
}
```

## üéß Currently Listening

## üîÅ Recently Played

## üîù Top Artists/Tracks
